<layout>
	<!-- date et heure -->
	<component type="datetime" format="%d/%m/%Y %H:%M:%S" cache="false" size="32" x="10" y="10"/>
	
	<!-- vitesse sol en km/h --> 
	<composite x="1735" y="890" name="speed"> 
		<!--component type="metric" metric="speed" units="kph" dp="0" size="48"/>
		<component type="metric_unit" metric="speed" units="kph" x="50" y="20" size="25">{:~P}</component-->
		<component type="msi" metric="speed" textsize="14" needle="1" units="kph" size="160" end="80" yellow="80" green="80"/>
		<component type="metric" metric="speed" units="kph" dp="0" size="36" x="80"  y="120" align="centre"/>
		<component type="metric_unit" metric="speed" units="kph" size="18"  x="80"  y="160" align="centre">{:~P}</component>	
	</composite>
	
	<!-- bpm -->
	<composite x="1900" y="10" name="bpm">
        <component type="metric_unit" metric="hr" x="-70" y="0" size="16" align="right">{:~P}</component>
        <component type="icon" x="-64" y="0" file="heartbeat.png" size="40"/>
        <component type="metric" x="-70" y="18" metric="hr" dp="0" size="32" align="right"/>
<!--		<component type="custom_calc" x="-70" y="40" size="20" align="right" expression="state.update({'sum': state.get('hr', 0) + (hr if hr > 5 else 0), 'count': state.get('count', 0) + (1 if hr > 5 else 0)}) or (state['sum'] / state['count'] if state['count'] > 0 else 0)"/>-->
<!--		expression="state.update({'hrmax': max(state.get('hrmax', 0), hr)}) or state['hrmax']"-->
		<composite x="-100" y="50">
			<composite x="-10" name="bpm_min">
				<component type="text" size="12" align="right">min</component>
				<component type="custom_calc" y="10" size="18" dp="0"  expression="precalc.get('min_hr', 0)" align="right"/>
			</composite>
			<composite x="25" name="bpm_max">
				<component type="text" size="12" align="right">max</component>
				<component type="custom_calc" y="10" size="18" dp="0"  expression="precalc.get('max_hr', 0)" align="right"/>
			</composite>
		</composite>
    </composite>

	<!-- altitude -->
	<composite x="1900" y="110" name="alt">
		<component type="metric_unit" metric="alt" x="-70" y="0" size="16" align="right">{:~P}</component>
		<component type="icon" x="-64" y="0" file="mountain.png" size="40"/>
		<component type="metric" metric="alt" x="-70" y="18" dp="0" size="32" align="right" />
<!--		<component type="custom_calc" x="-70" y="60" size="20" align="right" dp="0" expression="state.update({'altmax': max(state.get('altmax', 0), alt)}) or state['altmax']" />-->
		<composite x="-110" y="50">
			<composite x="0" name="alt-min">
				<component type="text" size="12" align="right">min</component>
				<component type="custom_calc" y="10" size="18" dp="0" expression="precalc.get('min_alt', 0)" align="right"/>
			</composite>
			<composite x="40" name="alt_max">
				<component type="text" size="12" align="right">max</component>
				<component type="custom_calc" y="10" size="18" dp="0" expression="precalc.get('max_alt', 0)" align="right"/>
			</composite>
		</composite>
	</composite>

	<!-- dénivelé -->
	<composite x="1900" y="210" name="deniv">
		<component type="text" x="-70" size="16" align="right">m</component>
		<component type="icon" x="-64" y="0" file="slope.png" size="40" />
		<component type="custom-calc" x="-70" y="18" expression="precalc.get('total_gain', 0)" label="D+" dp="0" size="32" align="right" />
		<component type="custom-calc" x="-70" y="50" expression="precalc.get('total_loss', 0)" label="D-" dp="0" size="32" align="right" />
	</composite>

	<composite x="1900" y="310" name="vario">
		<component type="text" x="-70" size="16" align="right">m/s</component>
		<component type="icon" x="-64" y="0" file="slope-triangle.png" size="40" />
		<component type="custom-calc" x="-70" y="18" dp="2" size="32" align="right" expression="(grad / 10) * (speed / 3.6)"/>
	</composite>

	<!-- acceleration verticale -->
	<composite x="1900" y="400" name="accelz">
		<component type="metric_unit" metric="accl.z" x="-70" y="0" size="16" align="right">{:~P}</component>
		<component type="icon" x="-64" y="0" file="slope-triangle.png" size="64"/>
		<component type="metric" metric="accl.z" x="-70" y="18" dp="0" size="32" align="right" />
	</composite>
  

	<!-- carte -->
	<translate x="10" y="850">
		<frame  width="220" height="220" cr="20">
			<component type="journey_map" size="220" opacity="0.7"  />
		</frame>
		<!-- distance --> 
		<component type="metric_unit" metric="odo" x="120" y="180" size="16" align="right">{:~P}</component>
		<component type="metric" metric="odo"  align="right" x="120" y="200" size="20"/>
		<!-- orientation -->
		<!-- component type="metric"  metric="azi" size="125"/-->
	</translate>

	<composite x="240" y="850" name="deco/attero">
		<component type="text" size="16">Deco (m)</component>
		<component type="custom-calc" y="15" expression="state.setdefault('alt_start', alt)" dp="0" size="32" />

		<component type="text" y="60" size="16">Attero (m)</component>
    	<component type="custom-calc" y="80" expression="precalc.get('min_alt', 0)" dp="0" size="32"  />
	</composite>

</layout>
